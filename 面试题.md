#### Spring循环依赖：

通过递归方式，先实例化目标对象，再实例化依赖对象。

#### DI和ioc是什么

#### Spring常用的设计模式

单例模式：

工厂模式：

代理模式：

模板方法：

观察者：

#### 单例模式如何保证线程安全

DCL，不推荐

类加载机制

枚举

#### SpringMVC流程：

1.在DispatcherServlet中调用handlerMapping处理器映射器方法，找到具体的处理器代理对象；

调用handlerAdapter处理器适配器

调用具体的处理器；

返回ModelAndView；

DispatcherServlet将视图传给视图解析器解析；

解析出具体的View；

对试图进行渲染；

响应给用户；

#### SpringCloud常用组件

Eureka:服务注册与发现

Zuul：网关；阻塞式网络模型；

Ribbon: 客户端负载均衡

Feign: 声明式Web服务客户端

Hystrix: 

​	服务降级：当发生以下情况时，快速返回一个友好的提示：

​					程序运行异常|超时|服务熔断|限流

​	服务限流：信号量

​	服务熔断：断路器基于三种状态打开，关闭，半开；

Config: 配置中心

#### zookepper

持久节点：

临时节点：

TTL：可以对一个键或目录设置一个存活时间。当指定时间内没有更新并且没有子节点，这个节点将在服务端删除。

watch机制：

zk分布式锁机制：一种是在根目录创建一个临时节点，成功创建则代表拥有锁；同时有其他线程在创建该节点，但失败，则会watch该节点。（注意惊群现象）

另一种是创建一个顺序节点，每个后继节点去watch前驱节点。

选举机制：

启动选举：每个节点都投票给自己，然后进行pk,根据事务id和myid。相同事务id比较myid。myid最大的胜出。

崩溃选举：leader故障后，从节点进入looking状态；各节点投票，先投自己，再广播；接收到的广播信息，进行对比，如果本节点小，改变投票信息为接收到的信息，重新广播；统计本地投票，超半数节点切换为leading状态并广播。

zab协议：包含了两种模式：崩溃恢复和消息广播；

集群中的事务都由Leader节点处理。事务消息要广播给其他节点。其他节点回复。收到多半数回复后，会再次广播commit消息，确认之前的提交。

在以下情况中会崩溃恢复：初始化集群；Leader崩溃；Leader失去半数支持。

#### 分布式集群中为什么要有主节点？

减少重复计算

长连接的TCP，分包方式：

固定消息长度；特殊字符作为消息边界；消息头添加一个消息长度字段；利用格式标识（解析该格式使用状态机）

#### Netty的实现原理：

采用NIO+reactorIO模型
Netty中修复了NIO中的一个什么Bug?

epoll中Selector空轮询的bug。解决方式记录轮询次数，当达到512次后，将Selector中的Channel从新注册到新的Selector上，关掉原理的Selector;

#### JVM主要包含哪些东西：

JVM运行时数据区：

堆，方法区，虚拟机栈，本地方法栈，程序计数器

类加载机制

字节码执行引擎

本地方法库接口

垃圾收集

编译器

垃圾收集算法：

复制；标记清除；标记整理；分代收集。

#### kakfa是如何实现高吞吐

顺序写；预读；零拷贝；

kafka消息丢失：同步模式下，设置ACK为-1；异步模式下，设置生产者一直阻塞；

消息重复消费：幂等性校验。

redis常见的问题：

雪崩：redis大量的key在相同时间内失效，导致请求都打到数据库；

解决：随机设置过期时间。不设置过期；定时刷新缓存；

穿透：非常规场景下，非法key由于不存在于reids导致会查询数据库；

解决：布隆过滤器；参数校验；

击穿：高并发情况下，一个key失效后，大量请求打到数据库库；

解决：设置热点key永不过期；加互斥锁；

#### ES路由分片算法：

文档id哈希取模；

#### redis数据结构：

#### Mysql优化流程：

1. 开启慢查询;set global slow_query_log = 1;slow_query_log_file=路径

2. Explain分析sql执行计划

   重点关注：select_type;possible_keys;key;key_len;extra: using filesort|using temporary

   using filesort: 

   ​	order by 字段不是索引字段

   ​	order by 字段是索引字段，但select中没有使用覆盖索引；

   ​	order by 中同时存在升序和降序；

   ​	order by 中字段未按照最左前缀法则

   using temporary:

   ​	使用as作为一个临时表的时候，结果集也比较大的时候；

   Mysql索引数据结构：

   B+树：因为B+树所有数据存在于叶子节点，并且叶子节点已经被排序；这样可以进行范围查找；同时可以预读数据；

   

   



